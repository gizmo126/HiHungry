import urllib
import MySQLdb
import random
from config import DB_HOST, DB_USER, DB_PASSWORD, DB_DATABASE

# 4/12 - Used to populate user's favorite restaurants
def dbconnect():
    try:
        db = MySQLdb.connect(
            host = DB_HOST,
            user = DB_USER,
            passwd = DB_PASSWORD,
            db = DB_DATABASE
        )
        print("connected to db")
    except Exception as e:
        print(e)
    return db

db = dbconnect()
db.autocommit(True)
cursor = db.cursor()

insert_statement = (
    "INSERT INTO Favorite (user_id, restaurant_id)"
    "VALUES (%s, %s)"
)

rest_ids = [16717268, 16717315, 16718075, 16718098, 16718128, 16718204, 16718525, 16718605, 16718686, 16718687, 16718982, 16719032, 16719173, 16720700, 16720729, 16720764, 16720781, 16727499, 16728253, 16728552, 16732792, 16733182, 16734364, 16734461, 16734562, 16734669, 16735324, 16735580, 16736014, 16737207, 16737455, 16737523, 16739529, 16751801, 16751896, 16752484, 16752778, 16753200, 16754574, 16754997, 16759908, 16760100, 16761344, 16761402, 16761868, 16762160, 16764602, 16767139, 16769041, 16769089, 16769241, 16769546, 16771079, 16771494, 16772774, 16773829, 16775039, 16776778, 16777320, 16777384, 16807074, 16807372, 16808460, 16810579, 16810917, 16813268, 16814205, 16814344, 16819715, 16819859, 16820124, 16820386, 16821118, 16825525, 16825707, 16825758, 16825829, 16830337, 16830386, 16831684, 16840976, 16841952, 16842751, 16842986, 16843658, 16843902, 16844181, 16844681, 16844846, 16849192, 16849345, 16849962, 16850231, 16850754, 16851686, 16852971, 16852987, 16853056, 16859330, 16860927, 16865379, 16865453, 16865454, 16865735, 16865876, 16865946, 16866175, 16867526, 16867601, 16868280, 16868755, 16869122, 16869801, 16870521, 16872285, 16872442, 16872529, 16872537, 16872578, 16874529, 16879517, 16879755, 16879820, 16879830, 16880291, 16880456, 16881187, 16881352, 16881463, 16881604, 16881633, 16881849, 16881938, 16882313, 16882959, 16883547, 16884686, 16885112, 16885692, 16889921, 16894544, 16894545, 16894557, 16894562, 16894597, 16894710, 16894724, 16895009, 16895057, 16895679, 16895682, 16896046, 16896058, 16896059, 16896981, 16902339, 16902960, 16905753, 16905986, 16906739, 16918894, 16919000, 16921526, 16921606, 16922039, 16922776, 16923457, 16923709, 16923728, 16924354, 16924412, 16925116, 16925443, 16925475, 16926169, 16926339, 16930344, 16930992, 16932058, 16933515, 16939119, 16939354, 16939993, 16940385, 16940969, 16941974, 16942912, 16943076, 16943496, 16945822, 16945825, 16945931, 16946327, 16948822, 16949618, 16949791, 16950888, 16952555, 16953915, 16957564, 17068107, 17068202, 17068275, 17068305, 17069339, 17069389, 17069547, 17069791, 17069832, 17071536, 17071623, 17071662, 17071839, 17072393, 17072397, 17073168, 17074167, 17074417, 17076309, 17152524, 17152686, 17152688, 17152689, 17152775, 17153013, 17153026, 17153692, 17153940, 17154040, 17154168, 17154200, 17154396, 17154460, 17155119, 17155122, 17155123, 17155124, 17156582, 17158666, 17317216, 17317227, 17317281, 17317298, 17317336, 17317345, 17317351, 17317359, 17317399, 17317431, 17317683, 17317702, 17317704, 17317754, 17317789, 17317867, 17317911, 17317935, 17317943, 17317968]

for user_id in range(1, 33):
    for idx in range(0, 10):
        restaurant_id = rest_ids[random.randint(0, 258)]
        data = (user_id, restaurant_id)
        print data
        try:
            cursor.execute(insert_statement, data)
        except Exception as e:
            print(e)
            cursor.close()

# close the database connection
print("disconnecting from db")
db.close()
